\ExplSyntaxOn
\newtcolorbox{npc}[2][]
{
	colbacktitle=black!50!white,
	coltitle=white,
	colframe=white,
	title=#2,
	#1
}

\keys_define:nn { br / npc / attributes }
{
	description .tl_set:N = \l__description_tl,
	description .initial:n = this is a description,
	description .value_required:n = true,
	strength .tl_set:N = \l__strength_tl,
	strength .initial:n = C,
	strength .value_required:n = true,
	agility .tl_set:N = \l__agility_tl, 
	agility .initial:n = C,
	agility .value_required:n = true,
	intelligence .tl_set:N = \l__intelligence_tl, 
	intelligence .initial:n = C,
	intelligence .value_required:n = true,
	empathy .tl_set:N = \l__empathy_tl, 
	empathy .initial:n = C,
	empathy .value_required:n = true,
	skills .tl_set:N = \l__skills_tl,
	skills .initial:n = these are skills,
	skills .value_required:n = true,
	specialties .tl_set:N = \l__specialties_tl,
	specialties .initial:n = these are skills,
	specialties .value_required:n = true,
	gear .tl_set:N = \l__gear_tl,
	gear .initial:n = these are gear,
	gear .value_required:n = true,
	picture .tl_set:N = \l__picture_tl,
	picture .initial:n = example-image.pdf,
	picture .value_required:n = true,
}
\newcounter{TotalMembers}
\newcommand\SetTotalMembers[1]{
	\setcounter{TotalMembers}{0}
	\foreach \x in #1 {\stepcounter{TotalMembers}}
}
\newcounter{CurrentMemberCount}

\cs_new_protected_nopar:Npn \__br_if_npc_attribute:n #1
{
	\SetTotalMembers{#1}
	\tl_if_empty:NTF{#1}
	{---}
	{
		\readlist\foo #1
		\makecell[r]{
			\forloop
			{CurrentMemberCount}{1}
			{\value{CurrentMemberCount}<\value{TotalMembers}}{
				\foo[1]\\}\foo[\value{CurrentMemberCount}]
		}
	}

}

\cs_new_protected_nopar:Npn \__br_npc_attributes:
{
	\begin{multicols}{2}
		\l__description_tl
	\end{multicols}
	\begin{multicols}{2}
	\begin{tabularx}{\linewidth}{p{.30\linewidth} X}
		Attributes & \makecell[r]{
		Strength\, \l__strength_tl \\
		Agility\, \l__agility_tl \\
		Intelligence\, \l__intelligence_tl \\
		Empathy\, \l__empathy_tl} \\
	\hline
		Health & \makecell[r]{
			\number\numexpr(
				\valueFromLevel{\l__strength_tl} + 
				\valueFromLevel{\l__agility_tl}) /
				4 \relax
			}\\
			\hline
		Resolve & \makecell[r]{
			\number\numexpr(
				\valueFromLevel{\l__intelligence_tl} +
				\valueFromLevel{\l__empathy_tl}) /
				4 \relax
			}\\
			\hline
		Skills & \__br_if_npc_attribute:n \l__skills_tl \\
		\hline
		Specialties & \__br_if_npc_attribute:n \l__specialties_tl \\
		\hline
		Gear & \__br_if_npc_attribute:n \l__gear_tl \\
	\end{tabularx} \vfill\null \columnbreak
		\fitbox[maxwidth=.5\textwidth, maxheight=13\baselineskip]{\includegraphics[left]{\l__picture_tl}}
	\end{multicols}
}
\NewDocumentCommand{\BrNpcAttributes}{o}
{ 
	\group_begin:
		\keys_set:nn { br / npc / attributes } {#1}
		\__br_npc_attributes:
	\group_end:

}
\newcommand\valueFromLevel[1] {
	\if #1 A \number 12 \fi
	\if #1 B \number 10 \fi
	\if #1 C \number 8 \fi
	\if #1 D \number 6 \fi
}
